"use strict";

var $list,
    $global_stats,
    global_stats = {
  "series-count": 0,
  "episode-count": 0,
  "watched-episodes-count": 0
};

var formatNumber = function formatNumber(number) {
  return new Intl.NumberFormat("pt-BR").format(number);
};

function load_series_data() {
  $.getJSON("data.json").done(function (data) {
    draw_series(data);
  });
}

function draw_series(data) {
  $.each(data, function (index, series) {
    var $series = $("<section />").addClass("series card");
    var stats = {
      "episode-count": 0,
      "watched-episodes-count": 0
    }; // series title

    $("<h1 />").addClass("series-title").text(series["series-title"]).appendTo($series);
    var $series_stats = $("<div />").addClass("series-stats").appendTo($series); // episode grid

    var $episodes = $("<div />").addClass("episode-grid");

    if (series["seasons"]) {
      draw_seasons(series["seasons"], $episodes, stats);
    }

    $episodes.appendTo($series); // series stats

    var percent_watched = (stats["watched-episodes-count"] / stats["episode-count"] * 100).toFixed(0);
    $series_stats.text(stats["episode-count"] + " episodes, " + stats["watched-episodes-count"] + " watched (" + percent_watched + "%)");
    global_stats["series-count"]++;
    global_stats["episode-count"] += stats["episode-count"];
    global_stats["watched-episodes-count"] += stats["watched-episodes-count"];
    var global_percent_watched = (global_stats["watched-episodes-count"] / global_stats["episode-count"] * 100).toFixed(0);
    $global_stats.text(global_stats["episode-count"] + " episodes from " + global_stats["series-count"] + " series, " + global_stats["watched-episodes-count"] + " watched (" + global_percent_watched + "%)"); // append to page

    $list.append($series).masonry("appended", $series).masonry("layout");
  });
}

function draw_seasons(data, $episodes, stats) {
  $.each(data, function (index, season) {
    var $season = $("<div />").addClass("season");
    $("<span />").addClass("season-number").text(season["season-number"]).appendTo($season);

    for (var episode_number = 1; episode_number <= season["episode-count"]; episode_number++) {
      var $episode = $("<span />").addClass("episode").attr("title", "Season " + season["season-number"] + ", Episode " + episode_number).appendTo($season);
      stats["episode-count"]++;

      if (season["watched-episodes"] && (season["watched-episodes"] == "all" || season["watched-episodes"].indexOf(episode_number) >= 0)) {
        $episode.addClass("watched");
        stats["watched-episodes-count"]++;
      }
    }

    $season.appendTo($episodes);
  });
}

$(function () {
  $global_stats = $(".global-stats");
  $list = $(".series-list").masonry({
    "itemSelector": ".series",
    "columnWidth": ".series",
    "gutter": 16
  });
  load_series_data();
});
WebFont.load({
  google: {
    families: ["Roboto:400,500:latin"]
  },
  active: function active() {
    $list.masonry("layout");
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcmllcy5qcyJdLCJuYW1lcyI6WyIkbGlzdCIsIiRnbG9iYWxfc3RhdHMiLCJnbG9iYWxfc3RhdHMiLCJmb3JtYXROdW1iZXIiLCJudW1iZXIiLCJJbnRsIiwiTnVtYmVyRm9ybWF0IiwiZm9ybWF0IiwibG9hZF9zZXJpZXNfZGF0YSIsIiQiLCJnZXRKU09OIiwiZG9uZSIsImRhdGEiLCJkcmF3X3NlcmllcyIsImVhY2giLCJpbmRleCIsInNlcmllcyIsIiRzZXJpZXMiLCJhZGRDbGFzcyIsInN0YXRzIiwidGV4dCIsImFwcGVuZFRvIiwiJHNlcmllc19zdGF0cyIsIiRlcGlzb2RlcyIsImRyYXdfc2Vhc29ucyIsInBlcmNlbnRfd2F0Y2hlZCIsInRvRml4ZWQiLCJnbG9iYWxfcGVyY2VudF93YXRjaGVkIiwiYXBwZW5kIiwibWFzb25yeSIsInNlYXNvbiIsIiRzZWFzb24iLCJlcGlzb2RlX251bWJlciIsIiRlcGlzb2RlIiwiYXR0ciIsImluZGV4T2YiLCJXZWJGb250IiwibG9hZCIsImdvb2dsZSIsImZhbWlsaWVzIiwiYWN0aXZlIl0sIm1hcHBpbmdzIjoiOztBQUNBLElBQUFBLEtBQUE7QUFBQSxJQUFBQyxhQUFBO0FBQUEsSUFBQUMsWUFBQSxHQUFBO0FBQUEsa0JBQUEsQ0FBQTtBQUFBLG1CQUFBLENBQUE7QUFBQSw0QkFBQTtBQUFBLENBQUE7O0FBRUEsSUFBQUMsWUFBQSxHQUFBLFNBQUFBLFlBQUEsQ0FBQUMsTUFBQSxFQUFBO0FBQ0EsU0FBQSxJQUFBQyxJQUFBLENBQUFDLFlBQUEsQ0FBQSxPQUFBLEVBQUFDLE1BQUEsQ0FBQUgsTUFBQSxDQUFBO0FBQ0EsQ0FGQTs7QUFJQSxTQUFBSSxnQkFBQSxHQUFBO0FBQ0FDLEVBQUFBLENBQUEsQ0FBQUMsT0FBQSxDQUFBLFdBQUEsRUFBQUMsSUFBQSxDQUFBLFVBQUFDLElBQUEsRUFBQTtBQUNBQyxJQUFBQSxXQUFBLENBQUFELElBQUEsQ0FBQTtBQUNBLEdBRkE7QUFHQTs7QUFFQSxTQUFBQyxXQUFBLENBQUFELElBQUEsRUFBQTtBQUNBSCxFQUFBQSxDQUFBLENBQUFLLElBQUEsQ0FBQUYsSUFBQSxFQUFBLFVBQUFHLEtBQUEsRUFBQUMsTUFBQSxFQUFBO0FBQ0EsUUFBQUMsT0FBQSxHQUFBUixDQUFBLENBQUEsYUFBQSxDQUFBLENBQUFTLFFBQUEsQ0FBQSxhQUFBLENBQUE7QUFDQSxRQUFBQyxLQUFBLEdBQUE7QUFBQSx1QkFBQSxDQUFBO0FBQUEsZ0NBQUE7QUFBQSxLQUFBLENBRkEsQ0FJQTs7QUFDQVYsSUFBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBUyxRQUFBLENBQUEsY0FBQSxFQUFBRSxJQUFBLENBQUFKLE1BQUEsQ0FBQSxjQUFBLENBQUEsRUFBQUssUUFBQSxDQUFBSixPQUFBO0FBQ0EsUUFBQUssYUFBQSxHQUFBYixDQUFBLENBQUEsU0FBQSxDQUFBLENBQUFTLFFBQUEsQ0FBQSxjQUFBLEVBQUFHLFFBQUEsQ0FBQUosT0FBQSxDQUFBLENBTkEsQ0FRQTs7QUFDQSxRQUFBTSxTQUFBLEdBQUFkLENBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQVMsUUFBQSxDQUFBLGNBQUEsQ0FBQTs7QUFDQSxRQUFBRixNQUFBLENBQUEsU0FBQSxDQUFBLEVBQUE7QUFDQVEsTUFBQUEsWUFBQSxDQUFBUixNQUFBLENBQUEsU0FBQSxDQUFBLEVBQUFPLFNBQUEsRUFBQUosS0FBQSxDQUFBO0FBQ0E7O0FBQ0FJLElBQUFBLFNBQUEsQ0FBQUYsUUFBQSxDQUFBSixPQUFBLEVBYkEsQ0FlQTs7QUFDQSxRQUFBUSxlQUFBLEdBQUEsQ0FBQU4sS0FBQSxDQUFBLHdCQUFBLENBQUEsR0FBQUEsS0FBQSxDQUFBLGVBQUEsQ0FBQSxHQUFBLEdBQUEsRUFBQU8sT0FBQSxDQUFBLENBQUEsQ0FBQTtBQUNBSixJQUFBQSxhQUFBLENBQUFGLElBQUEsQ0FBQUQsS0FBQSxDQUFBLGVBQUEsQ0FBQSxHQUFBLGFBQUEsR0FBQUEsS0FBQSxDQUFBLHdCQUFBLENBQUEsR0FBQSxZQUFBLEdBQUFNLGVBQUEsR0FBQSxJ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LFFBQUE7QUFBQTtBQUZBLENBQUEiLCJmaWxlIjoic2VyaWVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmxldCAkbGlzdCwgJGdsb2JhbF9zdGF0cywgZ2xvYmFsX3N0YXRzID0geyBcInNlcmllcy1jb3VudFwiOiAwLCBcImVwaXNvZGUtY291bnRcIjogMCwgXCJ3YXRjaGVkLWVwaXNvZGVzLWNvdW50XCI6IDAgfTtcclxuXHJcbmNvbnN0IGZvcm1hdE51bWJlciA9IG51bWJlciA9PiB7XHJcblx0cmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdChcInB0LUJSXCIpLmZvcm1hdChudW1iZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsb2FkX3Nlcmllc19kYXRhKCkge1xyXG5cdCQuZ2V0SlNPTihcImRhdGEuanNvblwiKS5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdGRyYXdfc2VyaWVzKGRhdGEpO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3X3NlcmllcyhkYXRhKSB7XHJcblx0JC5lYWNoKGRhdGEsIGZ1bmN0aW9uKGluZGV4LCBzZXJpZXMpIHtcclxuXHRcdGxldCAkc2VyaWVzID0gJChcIjxzZWN0aW9uIC8+XCIpLmFkZENsYXNzKFwic2VyaWVzIGNhcmRcIik7XHJcblx0XHRsZXQgc3RhdHMgPSB7IFwiZXBpc29kZS1jb3VudFwiOiAwLCBcIndhdGNoZWQtZXBpc29kZXMtY291bnRcIjogMCB9O1xyXG5cclxuXHRcdC8vIHNlcmllcyB0aXRsZVxyXG5cdFx0JChcIjxoMSAvPlwiKS5hZGRDbGFzcyhcInNlcmllcy10aXRsZVwiKS50ZXh0KHNlcmllc1tcInNlcmllcy10aXRsZVwiXSkuYXBwZW5kVG8oJHNlcmllcyk7XHJcblx0XHRsZXQgJHNlcmllc19zdGF0cyA9ICQoXCI8ZGl2IC8+XCIpLmFkZENsYXNzKFwic2VyaWVzLXN0YXRzXCIpLmFwcGVuZFRvKCRzZXJpZXMpO1xyXG5cclxuXHRcdC8vIGVwaXNvZGUgZ3JpZFxyXG5cdFx0bGV0ICRlcGlzb2RlcyA9ICQoXCI8ZGl2IC8+XCIpLmFkZENsYXNzKFwiZXBpc29kZS1ncmlkXCIpO1xyXG5cdFx0aWYoc2VyaWVzW1wic2Vhc29uc1wiXSkge1xyXG5cdFx0XHRkcmF3X3NlYXNvbnMoc2VyaWVzW1wic2Vhc29uc1wiXSwgJGVwaXNvZGVzLCBzdGF0cyk7XHJcblx0XHR9XHJcblx0XHQkZXBpc29kZXMuYXBwZW5kVG8oJHNlcmllcyk7XHJcblxyXG5cdFx0Ly8gc2VyaWVzIHN0YXRzXHJcblx0XHRsZXQgcGVyY2VudF93YXRjaGVkID0gKChzdGF0c1tcIndhdGNoZWQtZXBpc29kZXMtY291bnRcIl0gLyBzdGF0c1tcImVwaXNvZGUtY291bnRcIl0pICogMTAwKS50b0ZpeGVkKDApO1xyXG5cdFx0JHNlcmllc19zdGF0cy50ZXh0KHN0YXRzW1wiZXBpc29kZS1jb3VudFwiXSArIFwiIGVwaXNvZGVzLCBcIiArIHN0YXRzW1wid2F0Y2hlZC1lcGlzb2Rlcy1jb3VudFwiXSArIFwiIHdhdGNoZWQgKFwiICsgcGVyY2VudF93YXRjaGVkICsgXCIlKVwiKTtcclxuXHJcblx0XHRnbG9iYWxfc3RhdHNbXCJzZXJpZXMtY291bnRcIl0rKztcclxuXHRcdGdsb2JhbF9zdGF0c1tcImVwaXNvZGUtY291bnRcIl0gKz0gc3RhdHNbXCJlcGlzb2RlLWNvdW50XCJdO1xyXG5cdFx0Z2xvYmFsX3N0YXRzW1wid2F0Y2hlZC1lcGlzb2Rlcy1jb3VudFwiXSArPSBzdGF0c1tcIndhdGNoZWQtZXBpc29kZXMtY291bnRcIl07XHJcblx0XHRsZXQgZ2xvYmFsX3BlcmNlbnRfd2F0Y2hlZCA9ICgoZ2xvYmFsX3N0YXRzW1wid2F0Y2hlZC1lcGlzb2Rlcy1jb3VudFwiXSAvIGdsb2JhbF9zdGF0c1tcImVwaXNvZGUtY291bnRcIl0pICogMTAwKS50b0ZpeGVkKDApO1xyXG5cdFx0JGdsb2JhbF9zdGF0cy50ZXh0KGdsb2JhbF9zdGF0c1tcImVwaXNvZGUtY291bnRcIl0gKyBcIiBlcGlzb2RlcyBmcm9tIFwiICsgZ2xvYmFsX3N0YXRzW1wic2VyaWVzLWNvdW50XCJdICsgXCIgc2VyaWVzLCBcIiArIGdsb2JhbF9zdGF0c1tcIndhdGNoZWQtZXBpc29kZXMtY291bnRcIl0gKyBcIiB3YXRjaGVkIChcIiArIGdsb2JhbF9wZXJjZW50X3dhdGNoZWQgKyBcIiUpXCIpO1xyXG5cclxuXHRcdC8vIGFwcGVuZCB0byBwYWdlXHJcblx0XHQkbGlzdC5hcHBlbmQoJHNlcmllcykubWFzb25yeShcImFwcGVuZGVkXCIsICRzZXJpZXMpLm1hc29ucnkoXCJsYXlvdXRcIik7XHJcblx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyYXdfc2Vhc29ucyhkYXRhLCAkZXBpc29kZXMsIHN0YXRzKSB7XHJcblx0JC5lYWNoKGRhdGEsIGZ1bmN0aW9uKGluZGV4LCBzZWFzb24pIHtcclxuXHRcdGxldCAkc2Vhc29uID0gJChcIjxkaXYgLz5cIikuYWRkQ2xhc3MoXCJzZWFzb25cIik7XHJcblxyXG5cdFx0JChcIjxzcGFuIC8+XCIpLmFkZENsYXNzKFwic2Vhc29uLW51bWJlclwiKS50ZXh0KHNlYXNvbltcInNlYXNvbi1udW1iZXJcIl0pLmFwcGVuZFRvKCRzZWFzb24pO1xyXG5cdFx0Zm9yKGxldCBlcGlzb2RlX251bWJlciA9IDE7IGVwaXNvZGVfbnVtYmVyIDw9IHNlYXNvbltcImVwaXNvZGUtY291bnRcIl07IGVwaXNvZGVfbnVtYmVyKyspIHtcclxuXHRcdFx0bGV0ICRlcGlzb2RlID0gJChcIjxzcGFuIC8+XCIpLmFkZENsYXNzKFwiZXBpc29kZVwiKS5hdHRyKFwidGl0bGVcIiwgXCJTZWFzb24gXCIgKyBzZWFzb25bXCJzZWFzb24tbnVtYmVyXCJdICsgXCIsIEVwaXNvZGUgXCIgKyBlcGlzb2RlX251bWJlcikuYXBwZW5kVG8oJHNlYXNvbik7XHJcblx0XHRcdHN0YXRzW1wiZXBpc29kZS1jb3VudFwiXSsrO1xyXG5cclxuXHRcdFx0aWYoc2Vhc29uW1wid2F0Y2hlZC1lcGlzb2Rlc1wiXSAmJiAoc2Vhc29uW1wid2F0Y2hlZC1lcGlzb2Rlc1wiXSA9PSBcImFsbFwiIHx8IHNlYXNvbltcIndhdGNoZWQtZXBpc29kZXNcIl0uaW5kZXhPZihlcGlzb2RlX251bWJlcikgPj0gMCkpIHtcclxuXHRcdFx0XHQkZXBpc29kZS5hZGRDbGFzcyhcIndhdGNoZWRcIik7XHJcblx0XHRcdFx0c3RhdHNbXCJ3YXRjaGVkLWVwaXNvZGVzLWNvdW50XCJdKys7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQkc2Vhc29uLmFwcGVuZFRvKCRlcGlzb2Rlcyk7XHJcblx0fSk7XHJcbn1cclxuXHJcbiQoZnVuY3Rpb24oKSB7XHJcblx0JGdsb2JhbF9zdGF0cyA9ICQoXCIuZ2xvYmFsLXN0YXRzXCIpO1xyXG5cclxuXHQkbGlzdCA9ICQoXCIuc2VyaWVzLWxpc3RcIikubWFzb25yeSh7XHJcblx0XHRcIml0ZW1TZWxlY3RvclwiOiBcIi5zZXJpZXNcIixcclxuXHRcdFwiY29sdW1uV2lkdGhcIjogXCIuc2VyaWVzXCIsXHJcblx0XHRcImd1dHRlclwiOiAxNlxyXG5cdH0pO1xyXG5cclxuXHRsb2FkX3Nlcmllc19kYXRhKCk7XHJcbn0pO1xyXG5cclxuV2ViRm9udC5sb2FkKHtcclxuXHRnb29nbGU6IHsgZmFtaWxpZXM6IFtcIlJvYm90bzo0MDAsNTAwOmxhdGluXCJdIH0sXHJcblx0YWN0aXZlOiBmdW5jdGlvbigpIHsgJGxpc3QubWFzb25yeShcImxheW91dFwiKTsgfVxyXG59KTtcclxuIl19